environemnt set up
Running the batch script
2021-04-04 00:38:35.004319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:45.208760: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-04 00:38:45.216447: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-04 00:38:45.219804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-04 00:38:45.251485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100S-PCIE-32GB computeCapability: 7.0
coreClock: 1.597GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 1.03TiB/s
2021-04-04 00:38:45.251525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:45.281967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-04 00:38:45.282038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-04 00:38:45.297118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-04 00:38:45.310504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-04 00:38:45.344424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-04 00:38:45.363370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-04 00:38:45.366528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-04 00:38:45.369347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-04 00:38:45.370386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:49.725466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 00:38:49.725534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-04 00:38:49.725551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-04 00:38:49.731244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 30128 MB memory) -> physical GPU (device: 0, name: Tesla V100S-PCIE-32GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-04-04 00:38:49.734251: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-04 00:38:49.736064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100S-PCIE-32GB computeCapability: 7.0
coreClock: 1.597GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 1.03TiB/s
2021-04-04 00:38:49.736114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:49.736147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-04 00:38:49.736170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-04 00:38:49.736191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-04 00:38:49.736216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-04 00:38:49.736237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-04 00:38:49.736257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-04 00:38:49.736279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-04 00:38:49.739613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-04 00:38:49.739653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 00:38:49.739668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-04 00:38:49.739681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-04 00:38:49.743060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 30128 MB memory) -> physical GPU (device: 0, name: Tesla V100S-PCIE-32GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-04-04 00:38:50.394187: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-04 00:38:50.395208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100S-PCIE-32GB computeCapability: 7.0
coreClock: 1.597GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 1.03TiB/s
2021-04-04 00:38:50.395248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:50.395272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-04 00:38:50.395282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-04 00:38:50.395292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-04 00:38:50.395301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-04 00:38:50.395310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-04 00:38:50.395319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-04 00:38:50.395328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-04 00:38:50.396903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-04 00:38:50.397150: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-04 00:38:50.398002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100S-PCIE-32GB computeCapability: 7.0
coreClock: 1.597GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 1.03TiB/s
2021-04-04 00:38:50.398026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-04 00:38:50.398043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-04 00:38:50.398053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-04 00:38:50.398061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-04 00:38:50.398070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-04 00:38:50.398082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-04 00:38:50.398091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-04 00:38:50.398100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-04 00:38:50.399633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-04 00:38:50.399666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-04 00:38:50.399672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-04 00:38:50.399678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-04 00:38:50.401296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30128 MB memory) -> physical GPU (device: 0, name: Tesla V100S-PCIE-32GB, pci bus id: 0000:3b:00.0, compute capability: 7.0)
2021-04-04 00:39:02.773977: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-04 00:39:02.774726: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2900000000 Hz
Using TensorFlow backend.
WARNING:tensorflow:AutoGraph could not transform <function Model.make_train_function.<locals>.train_function at 0x2b625f751840> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: 'arguments' object has no attribute 'posonlyargs'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
Does the system is built with CUDA?: True
Default GPU Device: /device:GPU:0
Classes: ['Tomato___Late_blight', 'Tomato___Tomato_Yellow_Leaf_Curl_Virus', 'Peach___healthy', 'Grape___Esca_(Black_Measles)', 'Potato___Late_blight', 'Pepper,_bell___Bacterial_spot', 'Strawberry___healthy', 'Orange___Haunglongbing_(Citrus_greening)', 'Tomato___Leaf_Mold', 'Apple___Black_rot', 'Strawberry___Leaf_scorch', 'Tomato___Early_blight', 'Cherry_(including_sour)___healthy', 'Corn_(maize)___Common_rust_', 'Blueberry___healthy', 'Potato___Early_blight', 'Pepper,_bell___healthy', 'Apple___Cedar_apple_rust', 'Grape___Leaf_blight_(Isariopsis_Leaf_Spot)', 'Tomato___Tomato_mosaic_virus', 'Tomato___Target_Spot', 'Tomato___healthy', 'Peach___Bacterial_spot', 'Corn_(maize)___Cercospora_leaf_spot Gray_leaf_spot', 'Tomato___Spider_mites Two-spotted_spider_mite', 'Corn_(maize)___healthy', 'Squash___Powdery_mildew', 'Cherry_(including_sour)___Powdery_mildew', 'Tomato___Bacterial_spot', 'Grape___Black_rot', 'Apple___healthy', 'Potato___healthy', 'Corn_(maize)___Northern_Leaf_Blight', 'Tomato___Septoria_leaf_spot', 'Raspberry___healthy', 'Soybean___healthy', 'Apple___Apple_scab', 'Grape___healthy']
Number of classes: 38
Total number of images: 54305
first_folder_path: /fs/scratch/PAA0023/dong760/PlantVillage-Dataset/raw/color/Tomato___Late_blight
Number of folder: 38
sample image path: /fs/scratch/PAA0023/dong760/PlantVillage-Dataset/raw/color/Tomato___Late_blight/5fdf3288-d5f4-4c70-9b12-95222b82d415___RS_Late.B 4942.JPG
Image size: (256, 256, 3)
Found 43456 images belonging to 38 classes.
Found 10849 images belonging to 38 classes.
Train size: 43456

====> Statistics: MODEL_NAME=InceptionV3, epochs=5, batch_size=16, validation_split=0.2, lr=0.001, momentum=0.9, steps_per_epoch =100, feature shape= (256, 256, 3), no_classes=38, loss_function=categorical_crossentropy
Epoch 1/5
2021-04-04 00:39:05.880958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-04 00:39:06.607735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-04 00:39:06.664003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
WARNING:tensorflow:AutoGraph could not transform <function Model.make_test_function.<locals>.test_function at 0x2b62bb2adc80> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: 'arguments' object has no attribute 'posonlyargs'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2716/2716 - 1847s - loss: 1.3866 - accuracy: 0.7439 - precision: 0.8274 - recall: 0.6944 - auc: 0.9731 - val_loss: 0.5292 - val_accuracy: 0.8284 - val_precision: 0.8779 - val_recall: 0.7937 - val_auc: 0.9909
Epoch 2/5
2716/2716 - 1858s - loss: 0.6008 - accuracy: 0.8177 - precision: 0.8610 - recall: 0.7900 - auc: 0.9870 - val_loss: 0.5178 - val_accuracy: 0.8431 - val_precision: 0.8777 - val_recall: 0.8213 - val_auc: 0.9886
Epoch 3/5
2716/2716 - 1860s - loss: 0.5468 - accuracy: 0.8389 - precision: 0.8732 - recall: 0.8160 - auc: 0.9876 - val_loss: 0.4923 - val_accuracy: 0.8484 - val_precision: 0.8797 - val_recall: 0.8269 - val_auc: 0.9893
Epoch 4/5
2716/2716 - 1841s - loss: 0.5159 - accuracy: 0.8505 - precision: 0.8806 - recall: 0.8296 - auc: 0.9881 - val_loss: 0.4730 - val_accuracy: 0.8552 - val_precision: 0.8870 - val_recall: 0.8349 - val_auc: 0.9907
Epoch 5/5
2716/2716 - 1825s - loss: 0.4893 - accuracy: 0.8596 - precision: 0.8871 - recall: 0.8419 - auc: 0.9889 - val_loss: 0.4992 - val_accuracy: 0.8616 - val_precision: 0.8860 - val_recall: 0.8444 - val_auc: 0.9870
2021-04-04 03:13:03.627209: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:AutoGraph could not transform <function canonicalize_signatures.<locals>.signature_wrapper at 0x2b6b476bbf28> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: 'arguments' object has no attribute 'posonlyargs'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
{'loss': [1.3865634202957153, 0.6008260250091553, 0.5467590093612671, 0.5158717036247253, 0.48927274346351624], 'accuracy': [0.7438788414001465, 0.8177466988563538, 0.8388714790344238, 0.8505154848098755, 0.8596051335334778], 'precision': [0.8273564577102661, 0.8609690070152283, 0.8732238411903381, 0.8805569410324097, 0.8871428966522217], 'recall': [0.6944265365600586, 0.7900404930114746, 0.815974771976471, 0.8295747637748718, 0.8418630361557007], 'auc': [0.9730743765830994, 0.9869785308837891, 0.9875580072402954, 0.9881409406661987, 0.9888657331466675], 'val_loss': [0.5291798710823059, 0.517794132232666, 0.4922831058502197, 0.47303205728530884, 0.4992249011993408], 'val_accuracy': [0.8283712863922119, 0.843119204044342, 0.8483731150627136, 0.8551940321922302, 0.8616462349891663], 'val_precision': [0.8778672814369202, 0.8776595592498779, 0.8796823024749756, 0.8869956731796265, 0.8859767913818359], 'val_recall': [0.7937136888504028, 0.8212738633155823, 0.8268964886665344, 0.8349156379699707, 0.8444096446037292], 'val_auc': [0.990913450717926, 0.9885944724082947, 0.9893452525138855, 0.9906886219978333, 0.9870161414146423]}
date and time = 04-04-2021_03-12-54
Saving the model to path: /users/PAA0023/dong760/plant_leaves_diagnosis/saved_models/InceptionV3_BatchSize_16_0.2ValSplit_04-04-2021_03-12-54_5epochs

Prediction Result: 
679/679 - 349s - loss: 0.4831 - accuracy: 0.8606 - precision: 0.8875 - recall: 0.8424 - auc: 0.9885
Result: [0.4831219017505646, 0.8606323003768921, 0.8874538540840149, 0.8423817753791809, 0.988502025604248]
Validation accuracy: 0.8606323003768921 Validation accuracy: 0.4831219017505646


p0312.ten.osc.edu:
                                                                               Req'd  Req'd   Elap 
Job id               Username Queue    Name                 SessID NDS   TSK   Memory Time Use S Time 
-------------------- -------- -------- -------------------- ------ ----- ----- ------ ----- - -----
3710060              dong760  gpuseria plant_disease_diagno --         1    48     -- 48:00 R 02:42
3710061              dong760  gpuseria plant_disease_diagno --         1    48     -- 48:00 R 02:42
3710068              dong760  gpuseria plant_disease_diagno --         1    48     -- 48:00 C 02:38
3710069              dong760  gpuseria plant_disease_diagno --         1    48     -- 48:00 R 02:40
The date when running current script is :
Sun Apr  4 03:19:17 EDT 2021
